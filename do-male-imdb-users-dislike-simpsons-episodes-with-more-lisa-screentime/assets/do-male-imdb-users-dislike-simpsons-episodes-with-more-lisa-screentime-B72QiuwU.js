const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./inputs-DoHVubAa.js","./inputs-Cuu9vI3M.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const mn="modulepreload",hn=function(e,t){return new URL(e,t).href},At={},w=function(t,n,o){let r=Promise.resolve();if(n&&n.length>0){let l=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(A=>({status:"fulfilled",value:A}),A=>({status:"rejected",reason:A}))))};const s=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),u=a?.nonce||a?.getAttribute("nonce");r=l(n.map(d=>{if(d=hn(d,o),d in At)return;At[d]=!0;const f=d.endsWith(".css"),A=f?'[rel="stylesheet"]':"";if(o)for(let N=s.length-1;N>=0;N--){const E=s[N];if(E.href===d&&(!f||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${A}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":mn,f||(g.as="script"),g.crossOrigin="",g.href=d,u&&g.setAttribute("nonce",u),document.head.appendChild(g),f)return new Promise((N,E)=>{g.addEventListener("load",N),g.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return r.then(s=>{for(const a of s||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})};class F extends Error{constructor(t,n){super(t),this.input=n}}F.prototype.name="RuntimeError";function _n(e){return e&&typeof e.next=="function"&&typeof e.return=="function"}function Me(e){return()=>e}function ge(e){return e}function bn(e){return()=>{throw e}}const gn=Array.prototype,yn=gn.map;function G(){}const Fe=1,ue=2,_e=3,se=Symbol("no-observer"),vn=Promise.resolve();function W(e,t,n,o){n||(n=se),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:Be,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:G,writable:!0},_module:{value:t},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:vn,writable:!0},_reachable:{value:n!==se,writable:!0},_rejector:{value:xn(this)},_shadow:{value:wn(t,o)},_type:{value:e},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}Object.defineProperties(W.prototype,{_pending:{value:Tn,writable:!0,configurable:!0},_fulfilled:{value:$n,writable:!0,configurable:!0},_rejected:{value:On,writable:!0,configurable:!0},_resolve:{value:Pn,writable:!0,configurable:!0},define:{value:An,writable:!0,configurable:!0},delete:{value:In,writable:!0,configurable:!0},import:{value:Cn,writable:!0,configurable:!0}});function wn(e,t){return t?.shadow?new Map(Object.entries(t.shadow).map(([n,o])=>[n,new W(ue,e).define([],o)])):null}function En(e){e._module._runtime._dirty.add(e),e._outputs.add(this)}function Sn(e){e._module._runtime._dirty.add(e),e._outputs.delete(this)}function Be(){throw Be}function B(){throw B}function xn(e){return t=>{throw t===B?t:t===Be?new F(`${e._name} is not defined`,e._name):t instanceof Error&&t.message?new F(t.message,e._name):new F(`${e._name} could not be resolved`,e._name)}}function Pt(e){return()=>{throw new F(`${e} is defined more than once`)}}function An(e,t,n){switch(arguments.length){case 1:{n=e,e=t=null;break}case 2:{n=t,typeof e=="string"?t=null:(t=e,e=null);break}}return Ve.call(this,e==null?null:String(e),t==null?[]:yn.call(t,this._resolve,this),typeof n=="function"?n:Me(n))}function Pn(e){return this._shadow?.get(e)??this._module._resolve(e)}function Ve(e,t,n){const o=this._module._scope,r=this._module._runtime;if(this._inputs.forEach(Sn,this),t.forEach(En,this),this._inputs=t,this._definition=n,this._value=void 0,n===G?r._variables.delete(this):r._variables.add(this),e!==this._name||o.get(e)!==this){let i,s;if(this._name)if(this._outputs.size)o.delete(this._name),s=this._module._resolve(this._name),s._outputs=this._outputs,this._outputs=new Set,s._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(this)]=s},this),s._outputs.forEach(r._updates.add,r._updates),r._dirty.add(s).add(this),o.set(this._name,s);else if((s=o.get(this._name))===this)o.delete(this._name);else if(s._type===_e)s._duplicates.delete(this),this._duplicate=void 0,s._duplicates.size===1&&(s=s._duplicates.keys().next().value,i=o.get(this._name),s._outputs=i._outputs,i._outputs=new Set,s._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(i)]=s}),s._definition=s._duplicate,s._duplicate=void 0,r._dirty.add(i).add(s),r._updates.add(s),o.set(this._name,s));else throw new Error;if(this._outputs.size)throw new Error;e&&((s=o.get(e))?s._type===_e?(this._definition=Pt(e),this._duplicate=n,s._duplicates.add(this)):s._type===ue?(this._outputs=s._outputs,s._outputs=new Set,this._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(s)]=this},this),r._dirty.add(s).add(this),o.set(e,this)):(s._duplicate=s._definition,this._duplicate=n,i=new W(_e,this._module),i._name=e,i._definition=this._definition=s._definition=Pt(e),i._outputs=s._outputs,s._outputs=new Set,i._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(s)]=i}),i._duplicates=new Set([this,s]),r._dirty.add(s).add(i),r._updates.add(s).add(i),o.set(e,i)):o.set(e,this)),this._name=e}return this._version>0&&++this._version,r._updates.add(this),r._compute(),this}function Cn(e,t,n){return arguments.length<3&&(n=t,t=e),Ve.call(this,String(t),[n._resolve(String(e))],ge)}function In(){return Ve.call(this,null,[],G)}function Tn(){this._observer.pending&&this._observer.pending()}function $n(e){this._observer.fulfilled&&this._observer.fulfilled(e,this._name)}function On(e){this._observer.rejected&&this._observer.rejected(e,this._name)}const qt=Symbol("variable"),Rt=Symbol("invalidation"),Mt=Symbol("visibility");function ye(e,t=[]){Object.defineProperties(this,{_runtime:{value:e},_scope:{value:new Map},_builtins:{value:new Map([["@variable",qt],["invalidation",Rt],["visibility",Mt],...t])},_source:{value:null,writable:!0}})}Object.defineProperties(ye.prototype,{_resolve:{value:Dn,writable:!0,configurable:!0},redefine:{value:Nn,writable:!0,configurable:!0},define:{value:Ln,writable:!0,configurable:!0},derive:{value:kn,writable:!0,configurable:!0},import:{value:qn,writable:!0,configurable:!0},value:{value:Mn,writable:!0,configurable:!0},variable:{value:Rn,writable:!0,configurable:!0},builtin:{value:jn,writable:!0,configurable:!0}});function Nn(e){const t=this._scope.get(e);if(!t)throw new F(`${e} is not defined`);if(t._type===_e)throw new F(`${e} is defined more than once`);return t.define.apply(t,arguments)}function Ln(){const e=new W(Fe,this);return e.define.apply(e,arguments)}function qn(){const e=new W(Fe,this);return e.import.apply(e,arguments)}function Rn(e,t){return new W(Fe,this,e,t)}async function Mn(e){let t=this._scope.get(e);if(!t)throw new F(`${e} is not defined`);if(t._observer===se){t=this.variable(!0).define([e],ge);try{return await ke(this._runtime,t)}finally{t.delete()}}else return ke(this._runtime,t)}async function ke(e,t){await e._compute();try{return await t._promise}catch(n){if(n===B)return ke(e,t);throw n}}function kn(e,t){const n=new Map,o=new Set,r=[];function i(a){let u=n.get(a);return u||(u=new ye(a._runtime,a._builtins),u._source=a,n.set(a,u),r.push([u,a]),o.add(a),u)}const s=i(this);for(const a of e){const{alias:u,name:l}=typeof a=="object"?a:{name:a};s.import(l,u??l,t)}for(const a of o)for(const[u,l]of a._scope)if(l._definition===ge){if(a===this&&s._scope.has(u))continue;const d=l._inputs[0]._module;d._source&&i(d)}for(const[a,u]of r)for(const[l,d]of u._scope){const f=a._scope.get(l);if(!(f&&f._type!==ue))if(d._definition===ge){const A=d._inputs[0],g=A._module;a.import(A._name,l,n.get(g)||g)}else a.define(l,d._inputs.map(Fn),d._definition)}return s}function Dn(e){let t=this._scope.get(e),n;if(!t)if(t=new W(ue,this),this._builtins.has(e))t.define(e,Me(this._builtins.get(e)));else if(this._runtime._builtin._scope.has(e))t.import(e,this._runtime._builtin);else{try{n=this._runtime._global(e)}catch(o){return t.define(e,bn(o))}n===void 0?this._scope.set(t._name=e,t):t.define(e,Me(n))}return t}function jn(e,t){this._builtins.set(e,t)}function Fn(e){return e._name}const Bn=typeof requestAnimationFrame=="function"?requestAnimationFrame:typeof setImmediate=="function"?setImmediate:e=>setTimeout(e,0);function kt(e,t=io){const n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:t}}),e)for(const o in e)new W(ue,n).define(o,[],e[o])}Object.defineProperties(kt.prototype,{_precompute:{value:Un,writable:!0,configurable:!0},_compute:{value:zn,writable:!0,configurable:!0},_computeSoon:{value:Yn,writable:!0,configurable:!0},_computeNow:{value:Wn,writable:!0,configurable:!0},dispose:{value:Vn,writable:!0,configurable:!0},module:{value:Gn,writable:!0,configurable:!0}});function Vn(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach(e=>{e._invalidate(),e._version=NaN})}function Gn(e,t=G){let n;if(e===void 0)return(n=this._init)?(this._init=null,n):new ye(this);if(n=this._modules.get(e),n)return n;this._init=n=new ye(this),this._modules.set(e,n);try{e(this,t)}finally{this._init=null}return n}function Un(e){this._precomputes.push(e),this._compute()}function zn(){return this._computing||(this._computing=this._computeSoon())}function Yn(){return new Promise(Bn).then(()=>this._disposed?void 0:this._computeNow())}async function Wn(){let e=[],t,n,o=this._precomputes;if(o.length){this._precomputes=[];for(const i of o)i();await Hn(3)}t=new Set(this._dirty),t.forEach(function(i){i._inputs.forEach(t.add,t);const s=ro(i);s>i._reachable?this._updates.add(i):s<i._reachable&&i._invalidate(),i._reachable=s},this),t=new Set(this._updates),t.forEach(function(i){i._reachable?(i._indegree=0,i._outputs.forEach(t.add,t)):(i._indegree=NaN,t.delete(i))}),this._computing=null,this._updates.clear(),this._dirty.clear(),t.forEach(function(i){i._outputs.forEach(Jn)});do{for(t.forEach(function(i){i._indegree===0&&e.push(i)});n=e.pop();)eo(n),n._outputs.forEach(r),t.delete(n);t.forEach(function(i){Xn(i)&&(no(i,new F("circular definition")),i._outputs.forEach(Kn),t.delete(i))})}while(t.size);function r(i){--i._indegree===0&&e.push(i)}}function Hn(e=0){let t=Promise.resolve();for(let n=0;n<e;++n)t=t.then(()=>{});return t}function Xn(e){const t=new Set(e._inputs);for(const n of t){if(n===e)return!0;n._inputs.forEach(t.add,t)}return!1}function Jn(e){++e._indegree}function Kn(e){--e._indegree}function Zn(e){return e._promise.catch(e._rejector)}function qe(e){return new Promise(function(t){e._invalidate=t})}function Qn(e,t){let n=typeof IntersectionObserver=="function"&&t._observer&&t._observer._node,o=!n,r=G,i=G,s,a;return n&&(a=new IntersectionObserver(([u])=>(o=u.isIntersecting)&&(s=null,r())),a.observe(n),e.then(()=>(a.disconnect(),a=null,i()))),function(u){return o?Promise.resolve(u):a?(s||(s=new Promise((l,d)=>(r=l,i=d))),s.then(()=>u)):Promise.reject()}}function eo(e){e._invalidate(),e._invalidate=G,e._pending();const t=e._value,n=++e._version,o=e._inputs,r=e._definition;let i=null;const s=e._promise=e._promise.then(a,a).then(u).then(l);function a(){return Promise.all(o.map(Zn))}function u(d){if(e._version!==n)throw B;for(let f=0,A=d.length;f<A;++f)switch(d[f]){case Rt:{d[f]=i=qe(e);break}case Mt:{i||(i=qe(e)),d[f]=Qn(i,e);break}case qt:{d[f]=e;break}}return r.apply(t,d)}function l(d){if(e._version!==n)throw B;return _n(d)?((i||qe(e)).then(oo(d)),to(e,n,d)):d}s.then(d=>{e._value=d,e._fulfilled(d)},d=>{d===B||e._version!==n||(e._value=void 0,e._rejected(d))})}function to(e,t,n){const o=e._module._runtime;let r;function i(u){return new Promise(l=>l(n.next(r))).then(({done:l,value:d})=>l?void 0:Promise.resolve(d).then(u))}function s(){const u=i(l=>{if(e._version!==t)throw B;return r=l,a(l,u).then(()=>o._precompute(s)),e._fulfilled(l),l});u.catch(l=>{l===B||e._version!==t||(a(void 0,u),e._rejected(l))})}function a(u,l){return e._value=u,e._promise=l,e._outputs.forEach(o._updates.add,o._updates),o._compute()}return i(u=>{if(e._version!==t)throw B;return r=u,o._precompute(s),u})}function no(e,t){e._invalidate(),e._invalidate=G,e._pending(),++e._version,e._indegree=NaN,(e._promise=Promise.reject(t)).catch(G),e._value=void 0,e._rejected(t)}function oo(e){return function(){e.return()}}function ro(e){if(e._observer!==se)return!0;const t=new Set(e._outputs);for(const n of t){if(n._observer!==se)return!0;n._outputs.forEach(t.add,t)}return!1}function io(e){return globalThis[e]}function ve(e,t,n){n=n||{};var o=e.ownerDocument,r=o.defaultView.CustomEvent;typeof r=="function"?r=new r(t,{detail:n}):(r=o.createEvent("Event"),r.initEvent(t,!1,!1),r.detail=n),e.dispatchEvent(r)}function Dt(e){return Array.isArray(e)||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function jt(e){return e===(e|0)+""}function k(e){const t=document.createElement("span");return t.className="observablehq--cellname",t.textContent=`${e} = `,t}const so=Symbol.prototype.toString;function ne(e){return so.call(e)}const{getOwnPropertySymbols:ao,prototype:{hasOwnProperty:uo}}=Object,{toStringTag:lo}=Symbol,Ft={},le=ao;function Ae(e,t){return uo.call(e,t)}function De(e){return e[lo]||e.constructor&&e.constructor.name||"Object"}function L(e,t){try{const n=e[t];return n&&n.constructor,n}catch{return Ft}}const co=[{symbol:"@@__IMMUTABLE_INDEXED__@@",name:"Indexed",modifier:!0},{symbol:"@@__IMMUTABLE_KEYED__@@",name:"Keyed",modifier:!0},{symbol:"@@__IMMUTABLE_LIST__@@",name:"List",arrayish:!0},{symbol:"@@__IMMUTABLE_MAP__@@",name:"Map"},{symbol:"@@__IMMUTABLE_ORDERED__@@",name:"Ordered",modifier:!0,prefix:!0},{symbol:"@@__IMMUTABLE_RECORD__@@",name:"Record"},{symbol:"@@__IMMUTABLE_SET__@@",name:"Set",arrayish:!0,setish:!0},{symbol:"@@__IMMUTABLE_STACK__@@",name:"Stack",arrayish:!0}];function Bt(e){try{let t=co.filter(({symbol:s})=>e[s]===!0);if(!t.length)return;const n=t.find(s=>!s.modifier),o=n.name==="Map"&&t.find(s=>s.modifier&&s.prefix),r=t.some(s=>s.arrayish),i=t.some(s=>s.setish);return{name:`${o?o.name:""}${n.name}`,symbols:t,arrayish:r&&!i,setish:i}}catch{return null}}const{getPrototypeOf:Ge,getOwnPropertyDescriptors:fo}=Object,Vt=Ge({});function Gt(e,t,n,o){let r=Dt(e),i,s,a,u;e instanceof Map?e instanceof e.constructor?(i=`Map(${e.size})`,s=po):(i="Map()",s=re):e instanceof Set?e instanceof e.constructor?(i=`Set(${e.size})`,s=mo):(i="Set()",s=re):r?(i=`${e.constructor.name}(${e.length})`,s=_o):(u=Bt(e))?(i=`Immutable.${u.name}${u.name==="Record"?"":`(${e.size})`}`,r=u.arrayish,s=u.arrayish?bo:u.setish?ho:yo):o?(i=De(e),s=go):(i=De(e),s=re);const l=document.createElement("span");l.className="observablehq--expanded",n&&l.appendChild(k(n));const d=l.appendChild(document.createElement("a"));d.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M4 7L0 1h8z' fill='currentColor' />
  </svg>`,d.appendChild(document.createTextNode(`${i}${r?" [":" {"}`)),d.addEventListener("mouseup",function(f){f.stopPropagation(),Ee(l,Ue(e,null,n,o))}),s=s(e);for(let f=0;!(a=s.next()).done&&f<20;++f)l.appendChild(a.value);if(!a.done){const f=l.appendChild(document.createElement("a"));f.className="observablehq--field",f.style.display="block",f.appendChild(document.createTextNode("  … more")),f.addEventListener("mouseup",function(A){A.stopPropagation(),l.insertBefore(a.value,l.lastChild.previousSibling);for(let g=0;!(a=s.next()).done&&g<19;++g)l.insertBefore(a.value,l.lastChild.previousSibling);a.done&&l.removeChild(l.lastChild.previousSibling),ve(l,"load")})}return l.appendChild(document.createTextNode(r?"]":"}")),l}function*po(e){for(const[t,n]of e)yield vo(t,n);yield*re(e)}function*mo(e){for(const t of e)yield zt(t);yield*re(e)}function*ho(e){for(const t of e)yield zt(t)}function*_o(e){for(let t=0,n=e.length;t<n;++t)t in e&&(yield V(t,L(e,t),"observablehq--index"));for(const t in e)!jt(t)&&Ae(e,t)&&(yield V(t,L(e,t),"observablehq--key"));for(const t of le(e))yield V(ne(t),L(e,t),"observablehq--symbol")}function*bo(e){let t=0;for(const n=e.size;t<n;++t)yield V(t,e.get(t),!0)}function*go(e){for(const n in fo(e))yield V(n,L(e,n),"observablehq--key");for(const n of le(e))yield V(ne(n),L(e,n),"observablehq--symbol");const t=Ge(e);t&&t!==Vt&&(yield Ut(t))}function*re(e){for(const n in e)Ae(e,n)&&(yield V(n,L(e,n),"observablehq--key"));for(const n of le(e))yield V(ne(n),L(e,n),"observablehq--symbol");const t=Ge(e);t&&t!==Vt&&(yield Ut(t))}function*yo(e){for(const[t,n]of e)yield V(t,n,"observablehq--key")}function Ut(e){const t=document.createElement("div"),n=t.appendChild(document.createElement("span"));return t.className="observablehq--field",n.className="observablehq--prototype-key",n.textContent="  <prototype>",t.appendChild(document.createTextNode(": ")),t.appendChild(O(e,void 0,void 0,void 0,!0)),t}function V(e,t,n){const o=document.createElement("div"),r=o.appendChild(document.createElement("span"));return o.className="observablehq--field",r.className=n,r.textContent=`  ${e}`,o.appendChild(document.createTextNode(": ")),o.appendChild(O(t)),o}function vo(e,t){const n=document.createElement("div");return n.className="observablehq--field",n.appendChild(document.createTextNode("  ")),n.appendChild(O(e)),n.appendChild(document.createTextNode(" => ")),n.appendChild(O(t)),n}function zt(e){const t=document.createElement("div");return t.className="observablehq--field",t.appendChild(document.createTextNode("  ")),t.appendChild(O(e)),t}function Ct(e){const t=window.getSelection();return t.type==="Range"&&(t.containsNode(e,!0)||e.contains(t.anchorNode)||e.contains(t.focusNode))}function Ue(e,t,n,o){let r=Dt(e),i,s,a,u;if(e instanceof Map?e instanceof e.constructor?(i=`Map(${e.size})`,s=wo):(i="Map()",s=ie):e instanceof Set?e instanceof e.constructor?(i=`Set(${e.size})`,s=Eo):(i="Set()",s=ie):r?(i=`${e.constructor.name}(${e.length})`,s=Ao):(u=Bt(e))?(i=`Immutable.${u.name}${u.name==="Record"?"":`(${e.size})`}`,r=u.arrayish,s=u.arrayish?xo:u.setish?So:Po):(i=De(e),s=ie),t){const f=document.createElement("span");return f.className="observablehq--shallow",n&&f.appendChild(k(n)),f.appendChild(document.createTextNode(i)),f.addEventListener("mouseup",function(A){Ct(f)||(A.stopPropagation(),Ee(f,Ue(e)))}),f}const l=document.createElement("span");l.className="observablehq--collapsed",n&&l.appendChild(k(n));const d=l.appendChild(document.createElement("a"));d.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M7 4L1 8V0z' fill='currentColor' />
  </svg>`,d.appendChild(document.createTextNode(`${i}${r?" [":" {"}`)),l.addEventListener("mouseup",function(f){Ct(l)||(f.stopPropagation(),Ee(l,Gt(e,null,n,o)))},!0),s=s(e);for(let f=0;!(a=s.next()).done&&f<20;++f)f>0&&l.appendChild(document.createTextNode(", ")),l.appendChild(a.value);return a.done||l.appendChild(document.createTextNode(", …")),l.appendChild(document.createTextNode(r?"]":"}")),l}function*wo(e){for(const[t,n]of e)yield Co(t,n);yield*ie(e)}function*Eo(e){for(const t of e)yield O(t,!0);yield*ie(e)}function*So(e){for(const t of e)yield O(t,!0)}function*xo(e){let t=-1,n=0;for(const o=e.size;n<o;++n)n>t+1&&(yield we(n-t-1)),yield O(e.get(n),!0),t=n;n>t+1&&(yield we(n-t-1))}function*Ao(e){let t=-1,n=0;for(const o=e.length;n<o;++n)n in e&&(n>t+1&&(yield we(n-t-1)),yield O(L(e,n),!0),t=n);n>t+1&&(yield we(n-t-1));for(const o in e)!jt(o)&&Ae(e,o)&&(yield ae(o,L(e,o),"observablehq--key"));for(const o of le(e))yield ae(ne(o),L(e,o),"observablehq--symbol")}function*ie(e){for(const t in e)Ae(e,t)&&(yield ae(t,L(e,t),"observablehq--key"));for(const t of le(e))yield ae(ne(t),L(e,t),"observablehq--symbol")}function*Po(e){for(const[t,n]of e)yield ae(t,n,"observablehq--key")}function we(e){const t=document.createElement("span");return t.className="observablehq--empty",t.textContent=e===1?"empty":`empty × ${e}`,t}function ae(e,t,n){const o=document.createDocumentFragment(),r=o.appendChild(document.createElement("span"));return r.className=n,r.textContent=e,o.appendChild(document.createTextNode(": ")),o.appendChild(O(t,!0)),o}function Co(e,t){const n=document.createDocumentFragment();return n.appendChild(O(e,!0)),n.appendChild(document.createTextNode(" => ")),n.appendChild(O(t,!0)),n}function Io(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),o=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return`${To(e.getUTCFullYear())}-${j(e.getUTCMonth()+1,2)}-${j(e.getUTCDate(),2)}${n||o||r||i?`T${j(n,2)}:${j(o,2)}${r||i?`:${j(r,2)}${i?`.${j(i,3)}`:""}`:""}Z`:""}`}function To(e){return e<0?`-${j(-e,6)}`:e>9999?`+${j(e,6)}`:j(e,4)}function j(e,t){return`${e}`.padStart(t,"0")}function $o(e){return Io(e,"Invalid Date")}var Oo=Error.prototype.toString;function No(e){return e.stack||Oo.call(e)}var Lo=RegExp.prototype.toString;function qo(e){return Lo.call(e)}const Re=20;function Ro(e,t,n,o){if(t===!1){if(Tt(e,/["\n]/g)<=Tt(e,/`|\${/g)){const l=document.createElement("span");o&&l.appendChild(k(o));const d=l.appendChild(document.createElement("span"));return d.className="observablehq--string",d.textContent=JSON.stringify(e),l}const s=e.split(`
`);if(s.length>Re&&!n){const l=document.createElement("div");o&&l.appendChild(k(o));const d=l.appendChild(document.createElement("span"));d.className="observablehq--string",d.textContent="`"+It(s.slice(0,Re).join(`
`));const f=l.appendChild(document.createElement("span")),A=s.length-Re;return f.textContent=`Show ${A} truncated line${A>1?"s":""}`,f.className="observablehq--string-expand",f.addEventListener("mouseup",function(g){g.stopPropagation(),Ee(l,O(e,t,!0,o))}),l}const a=document.createElement("span");o&&a.appendChild(k(o));const u=a.appendChild(document.createElement("span"));return u.className=`observablehq--string${n?" observablehq--expanded":""}`,u.textContent="`"+It(e)+"`",a}const r=document.createElement("span");o&&r.appendChild(k(o));const i=r.appendChild(document.createElement("span"));return i.className="observablehq--string",i.textContent=JSON.stringify(e.length>100?`${e.slice(0,50)}…${e.slice(-49)}`:e),r}function It(e){return e.replace(/[\\`\x00-\x09\x0b-\x19]|\${/g,Mo)}function Mo(e){var t=e.charCodeAt(0);switch(t){case 8:return"\\b";case 9:return"\\t";case 11:return"\\v";case 12:return"\\f";case 13:return"\\r"}return t<16?"\\x0"+t.toString(16):t<32?"\\x"+t.toString(16):"\\"+e}function Tt(e,t){for(var n=0;t.exec(e);)++n;return n}var ko=Function.prototype.toString,Do={prefix:"async ƒ"},jo={prefix:"async ƒ*"},$t={prefix:"class"},Fo={prefix:"ƒ"},Bo={prefix:"ƒ*"};function Vo(e,t){var n,o,r=ko.call(e);switch(e.constructor&&e.constructor.name){case"AsyncFunction":n=Do;break;case"AsyncGeneratorFunction":n=jo;break;case"GeneratorFunction":n=Bo;break;default:n=/^class\b/.test(r)?$t:Fo;break}return n===$t?oe(n,"",t):(o=/^(?:async\s*)?(\w+)\s*=>/.exec(r))?oe(n,"("+o[1]+")",t):(o=/^(?:async\s*)?\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(r))?oe(n,o[1]?"("+o[1].replace(/\s*,\s*/g,", ")+")":"()",t):(o=/^(?:async\s*)?function(?:\s*\*)?(?:\s*\w+)?\s*\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(r))?oe(n,o[1]?"("+o[1].replace(/\s*,\s*/g,", ")+")":"()",t):oe(n,"(…)",t)}function oe(e,t,n){var o=document.createElement("span");o.className="observablehq--function",n&&o.appendChild(k(n));var r=o.appendChild(document.createElement("span"));return r.className="observablehq--keyword",r.textContent=e.prefix,o.appendChild(document.createTextNode(t)),o}const{prototype:{toString:Go}}=Object;function O(e,t,n,o,r){let i=typeof e;switch(i){case"boolean":case"undefined":{e+="";break}case"number":{e=e===0&&1/e<0?"-0":e+"";break}case"bigint":{e=e+"n";break}case"symbol":{e=ne(e);break}case"function":return Vo(e,o);case"string":return Ro(e,t,n,o);default:{if(e===null){i=null,e="null";break}if(e instanceof Date){i="date",e=$o(e);break}if(e===Ft){i="forbidden",e="[forbidden]";break}switch(Go.call(e)){case"[object RegExp]":{i="regexp",e=qo(e);break}case"[object Error]":case"[object DOMException]":{i="error",e=No(e);break}default:return(n?Gt:Ue)(e,t,o,r)}break}}const s=document.createElement("span");o&&s.appendChild(k(o));const a=s.appendChild(document.createElement("span"));return a.className=`observablehq--${i}`,a.textContent=e,s}function Ee(e,t){e.classList.contains("observablehq--inspect")&&t.classList.add("observablehq--inspect"),e.parentNode.replaceChild(t,e),ve(t,"load")}const Uo=/\s+\(\d+:\d+\)$/m;class Se{constructor(t){if(!t)throw new Error("invalid node");this._node=t,t.classList.add("observablehq")}pending(){const{_node:t}=this;t.classList.remove("observablehq--error"),t.classList.add("observablehq--running")}fulfilled(t,n){const{_node:o}=this;if((!zo(t)||t.parentNode&&t.parentNode!==o)&&(t=O(t,!1,o.firstChild&&o.firstChild.classList&&o.firstChild.classList.contains("observablehq--expanded"),n),t.classList.add("observablehq--inspect")),o.classList.remove("observablehq--running","observablehq--error"),o.firstChild!==t)if(o.firstChild){for(;o.lastChild!==o.firstChild;)o.removeChild(o.lastChild);o.replaceChild(t,o.firstChild)}else o.appendChild(t);ve(o,"update")}rejected(t,n){const{_node:o}=this;for(o.classList.remove("observablehq--running"),o.classList.add("observablehq--error");o.lastChild;)o.removeChild(o.lastChild);var r=document.createElement("div");r.className="observablehq--inspect",n&&r.appendChild(k(n)),r.appendChild(document.createTextNode((t+"").replace(Uo,""))),o.appendChild(r),ve(o,"error",{error:t})}}Se.into=function(e){if(typeof e=="string"&&(e=document.querySelector(e),e==null))throw new Error("container not found");return function(){return new Se(e.appendChild(document.createElement("div")))}};function zo(e){return(e instanceof Element||e instanceof Text)&&e instanceof e.constructor}function Yo(e,t){const n=document.createElement("div");if(new Se(n).fulfilled(e),t)for(const o of t){let r=n;for(const i of o)r=r?.childNodes[i];r?.dispatchEvent(new Event("mouseup"))}return n}function Wo(e){const t=document.createElement("div");return new Se(t).rejected(e),t}function Ho(e){if(!Jo(e))return;const t=e.querySelectorAll(".observablehq--expanded");if(t.length)return Array.from(t,n=>Ko(e,n))}function Xo(e){return e.nodeType===1}function Jo(e){return Xo(e)&&e.classList.contains("observablehq")}function Ko(e,t){const n=[];for(;t!==e;)n.push(Zo(t)),t=t.parentNode;return n.reverse()}function Zo(e){return Array.prototype.indexOf.call(e.parentNode.childNodes,e)}const Qo=["audio source[src]","audio[src]","img[src]","picture source[src]","video source[src]","video[src]"].join(),er=["img[srcset]","picture source[srcset]"].join(),tr=["a[href][download]","link[href]"].join(),nr=[[Qo,"src"],[er,"srcset"],[tr,"href"]];function or(e,t){const n=o=>t.get(sr(o))??o;for(const[o,r]of nr)for(const i of e.querySelectorAll(o)){if(rr(i))continue;const s=decodeURI(i.getAttribute(r));r==="srcset"?i.setAttribute(r,ur(s,n)):i.setAttribute(r,n(s))}}function rr(e){return/(?:^|\s)external(?:\s|$)/i.test(e.getAttribute("rel")??"")}function ir(e){const t=e.indexOf("?"),n=e.indexOf("#"),o=t>=0&&n>=0?Math.min(t,n):t>=0?t:n;return o>=0?e.slice(0,o):e}function sr(e){const t=ir(e);return ar(t)?t:`./${t}`}function ar(e){return["./","../","/"].some(t=>e.startsWith(t))}function ur(e,t){return e.trim().split(/\s*,\s*/).filter(n=>n).map(n=>{const o=n.split(/\s+/),r=t(o[0]);return r&&(o[0]=encodeURI(r)),o.join(" ")}).join(", ")}function Yt(e,t){const{root:n,expanded:o}=e,r=cr(t,n)?t:Yo(t,o[n.childNodes.length]);Wt(e,r)}function Wt(e,t){if(t.nodeType===11){let n;for(;n=t.firstChild;)e.root.appendChild(n)}else e.root.appendChild(t)}function lr(e,t){Wt(e,Wo(t))}function cr(e,t){return(e instanceof Element||e instanceof Text)&&e instanceof e.constructor&&(!e.parentNode||t.contains(e))}function ee(e){for(e.autoclear=!1,e.expanded=Array.from(e.root.childNodes,Ho);e.root.lastChild;)e.root.lastChild.remove()}function dr(e,{autodisplay:t,assets:n}){return{_error:!1,_node:e.root,pending(){this._error&&(this._error=!1,ee(e))},fulfilled(o){t?(n&&o instanceof Element&&or(o,n),ee(e),Yt(e,o)):e.autoclear&&ee(e)},rejected(o){console.error(o),this._error=!0,ee(e),lr(e,o)}}}async function*Pe(e){let t,n,o=!1;const r=e(i=>(n=i,t?(t(i),t=void 0):o=!0,i));if(r!=null&&typeof r!="function")throw new Error(typeof r=="object"&&"then"in r&&typeof r.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");try{for(;;)yield o?(o=!1,n):new Promise(i=>t=i)}finally{r?.()}}function je(e){return Pe(t=>{const n=fr(e),o=Ot(e),r=()=>t(Ot(e));return e.addEventListener(n,r),o!==void 0&&t(o),()=>e.removeEventListener(n,r)})}function Ot(e){const t=e,n=e;if("type"in e)switch(e.type){case"range":case"number":return t.valueAsNumber;case"date":return t.valueAsDate;case"checkbox":return t.checked;case"file":return t.multiple?t.files:t.files[0];case"select-multiple":return Array.from(n.selectedOptions,o=>o.value)}return t.value}function fr(e){if("type"in e)switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change"}return"input"}async function*Ht(){for(;;)yield Date.now()}async function*pr(e){let t;const n=[],o=e(r=>(n.push(r),t&&(t(n.shift()),t=void 0),r));if(o!=null&&typeof o!="function")throw new Error(typeof o=="object"&&"then"in o&&typeof o.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");try{for(;;)yield n.length?n.shift():new Promise(r=>t=r)}finally{o?.()}}function Xt(e,t){return Pe(n=>{let o;const r=new ResizeObserver(([i])=>{const s=i.contentRect.width;s!==o&&n(o=s)});return r.observe(e,t),()=>r.disconnect()})}const mr=Object.freeze(Object.defineProperty({__proto__:null,input:je,now:Ht,observe:Pe,queue:pr,width:Xt},Symbol.toStringTag,{value:"Module"}));function Jt(e){let t;return Object.defineProperty(Pe(n=>{t=n,e!==void 0&&t(e)}),"value",{get:()=>e,set:n=>(e=n,void t?.(e))})}function hr(e){const t=Jt(e);return[t,{get value(){return t.value},set value(n){t.value=n}}]}function _r(e,t,n,o=dr){const{id:r,body:i,inputs:s=[],outputs:a=[],output:u,autodisplay:l,autoview:d,automutable:f}=n,A=t.variables,g=e.variable(o(t,n),{shadow:{}}),N=u??(a.length?`cell ${r}`:null);if(t.autoclear=!0,s.includes("display")||s.includes("view")){let E=-1;const I=new g.constructor(2,g._module);if(I.define(s.filter(T=>T!=="display"&&T!=="view"),()=>{const T=g._version;return H=>{if(T<E)throw new Error("stale display");if(t.variables[0]!==g)throw new Error("stale display");return T>E&&ee(t),E=T,Yt(t,H),H}}),g._shadow.set("display",I),s.includes("view")){const T=new g.constructor(2,g._module,null,{shadow:{}});T._shadow.set("display",I),T.define(["display"],H=>Ce=>je(H(Ce))),g._shadow.set("view",T)}}else l||ee(t);if(A.push(g.define(N,s,i)),u!=null){if(d){const E=Nt(u,"viewof$");A.push(e.define(E,[u],je))}else if(f){const E=Nt(u,"mutable "),I=`cell ${r}`;g.define(E,[I],([T])=>T),A.push(e.define(u,s,i),e.define(I,[u],hr),e.define(`mutable$${E}`,[I],([,T])=>T))}}else for(const E of a)A.push(e.variable(!0).define(E,[N],I=>I[E]))}function Nt(e,t){if(!e.startsWith(t))throw new Error(`expected ${t}: ${e}`);return e.slice(t.length)}const Lt=new Map,ze=(e,t=document.baseURI)=>{const n=new URL(e,t).href;let o=Lt.get(n);return o||(o=new te(n,e.split("/").pop()),Lt.set(n,o)),o};async function Q(e){const t=await fetch(e.href);if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}class br{constructor(t,n=gr(t),o,r){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mimeType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lastModified",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperties(this,{name:{value:`${t}`,enumerable:!0},mimeType:{value:`${n}`,enumerable:!0},lastModified:{value:o===void 0?void 0:+o,enumerable:!0},size:{value:r===void 0?void 0:+r,enumerable:!0}})}async url(){return this.href}async blob(){return(await Q(this)).blob()}async arrayBuffer(){return(await Q(this)).arrayBuffer()}async text(t){return t===void 0?(await Q(this)).text():new TextDecoder(t).decode(await this.arrayBuffer())}async json(){return(await Q(this)).json()}async stream(){return(await Q(this)).body}async dsv({delimiter:t=",",array:n=!1,typed:o=!1}={}){const[r,i]=await Promise.all([this.text(),w(()=>import("https://cdn.jsdelivr.net/npm/d3-dsv/+esm"),[],import.meta.url)]),s=i.dsvFormat(t);return(n?s.parseRows:s.parse)(r,o&&i.autoType)}async csv(t){return this.dsv({...t,delimiter:","})}async tsv(t){return this.dsv({...t,delimiter:"	"})}async image(t){const n=await this.url();return new Promise((o,r)=>{const i=new Image;new URL(n,document.baseURI).origin!==location.origin&&(i.crossOrigin="anonymous"),Object.assign(i,t),i.onload=()=>o(i),i.onerror=()=>r(new Error(`Unable to load file: ${this.name}`)),i.src=n})}async arrow(){const[t,n]=await Promise.all([w(()=>import("https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm"),[],import.meta.url),Q(this)]);return t.tableFromIPC(n)}async arquero(t){let n,o;switch(this.mimeType){case"application/json":n=this.text(),o="fromJSON";break;case"text/tab-separated-values":t?.delimiter===void 0&&(t={...t,delimiter:"	"});case"text/csv":n=this.text(),o="fromCSV";break;default:if(/\.arrow$/i.test(this.name))n=this.arrow(),o="fromArrow";else if(/\.parquet$/i.test(this.name))n=this.parquet(),o="fromArrow";else throw new Error(`unable to determine Arquero loader: ${this.name}`);break}const[r,i]=await Promise.all([w(()=>import("https://cdn.jsdelivr.net/npm/arquero/+esm"),[],import.meta.url),n]);return r[o](i,t)}async parquet(){const[t,n,o]=await Promise.all([w(()=>import("https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm"),[],import.meta.url),w(()=>import("https://cdn.jsdelivr.net/npm/parquet-wasm/+esm"),[],import.meta.url).then(async r=>(await r.default("https://cdn.jsdelivr.net/npm/parquet-wasm/esm/parquet_wasm_bg.wasm"),r)),this.arrayBuffer()]);return t.tableFromIPC(n.readParquet(new Uint8Array(o)).intoIPCStream())}async xml(t="application/xml"){return new DOMParser().parseFromString(await this.text(),t)}async html(){return this.xml("text/html")}}function gr(e){const t=e.lastIndexOf("."),n=e.lastIndexOf("/");switch(t>0&&(n<0||t>n)?e.slice(t).toLowerCase():""){case".csv":return"text/csv";case".tsv":return"text/tab-separated-values";case".json":return"application/json";case".html":return"text/html";case".xml":return"application/xml";case".png":return"image/png";case".jpg":return"image/jpg";case".js":return"text/javascript";default:return"application/octet-stream"}}class te extends br{constructor(t,n,o,r,i){super(n,o,r,i),Object.defineProperty(this,"href",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"href",{value:t})}}Object.defineProperty(te,"name",{value:"FileAttachment"});ze.prototype=te.prototype;function yr(e){function t(n){const o=e(n+="");if(o==null)throw new Error(`File not found: ${n}`);if(typeof o=="object"&&"url"in o){const{url:r,mimeType:i}=o;return new te(r,n,i)}return new te(o,n)}return t.prototype=te.prototype,t}function vr(e,{length:t=50,fallback:n="untitled",separator:o="-"}={}){const r=e.normalize("NFD").replace(/[\u0300-\u036f'‘’]/g,"").toLowerCase().split(/\W+/g).filter(wr);let i=-1;for(let s=0,a=r.length;++i<a;)if((s+=r[i].length)+i>t){r[i]=r[i].substring(0,t-s+r[i].length-i);break}return r.slice(0,i+1).filter(Boolean).join(o)||n.slice(0,t)}function wr(e){return e.length>0}async function Ye(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t);return new Uint8Array(n).reduce((o,r)=>o<<8n|BigInt(r),0n)}function We(e,t){return e.toString(36).padStart(t,"0").slice(0,t)}async function Er(e,...t){return We(await Ye(JSON.stringify([e,...t])),16)}async function Sr(e){return We(await Ye(e),16)}async function Kt(e){return/^[\w-]+$/.test(e)?e:`${vr(xr(e))}.${We(await Ye(e),8)}`}function xr(e){return e.replace(/^.*\//,"")}const He=(e,t)=>new Xe(e,Ar(t));function Ar({id:e,since:t}={}){const n={};return e!==void 0&&(n.id=e),t!==void 0&&(n.since=new Date(t)),n}class Xe{constructor(t,n){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperties(this,{name:{value:t,enumerable:!0},options:{value:n,enumerable:!0}})}async sql(t,...n){const o=await this.cachePath(t,...n),r=await fetch(o);if(!r.ok)throw new Error(`failed to fetch: ${o}`);return await r.json().then(Zt)}async cachePath(t,...n){return`.observable/cache/${await Kt(this.name)}-${await Er(t,...n)}.json`}}function Zt({rows:e,schema:t,date:n,...o}){for(const r of t)switch(r.type){case"bigint":{const{name:i}=r;for(const s of e){const a=s[i];a!=null&&(s[i]=Number(a))}break}case"date":{const{name:i}=r;for(const s of e){const a=s[i];a!=null&&(s[i]=Pr(a))}break}}return n!=null&&(n=new Date(n)),Object.assign(e,{schema:t,date:n},o)}function Pr(e){return new Date(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}(?::\d{2})?$/.test(e)?e+"Z":e)}He.revive=Zt;He.prototype=Xe.prototype;Object.defineProperty(Xe,"name",{value:"DatabaseClient"});function Cr(e,t){const n=document.createElement("canvas");return n.width=e,n.height=t,n}function Ir(e,t,n=devicePixelRatio){const o=document.createElement("canvas");o.width=e*n,o.height=t*n,o.style.width=`${e}px`;const r=o.getContext("2d");return r.scale(n,n),r}function Tr(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",`0 0 ${e} ${t}`),n.setAttribute("width",`${e}`),n.setAttribute("height",`${t}`),n}function $r(e){return document.createTextNode(e)}let Or=0;function Nr(e){return new Lr(`O-${e==null?"":`${e}-`}${++Or}`)}class Lr{constructor(t){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"href",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=t,this.href=new URL(`#${t}`,location.href).href}toString(){return`url(${this.href})`}}const qr=Object.freeze(Object.defineProperty({__proto__:null,canvas:Cr,context2d:Ir,svg:Tr,text:$r,uid:Nr},Symbol.toStringTag,{value:"Module"}));function Rr(e){switch(e){case"html":case"text":return".txt";case"jpeg":return".jpg";case"json":case"arrow":case"parquet":case"csv":case"tsv":case"png":case"gif":case"svg":case"webp":case"xml":return`.${e}`;default:return".bin"}}const Qt=(e,t)=>new Je(e,Mr(t));function Mr({format:e="buffer",id:t,since:n}={}){const o={format:e};return t!==void 0&&(o.id=t),n!==void 0&&(o.since=new Date(n)),o}class Je{constructor(t,n){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperties(this,{name:{value:t,enumerable:!0},options:{value:n,enumerable:!0}})}async run(t){return ze(await this.cachePath(t))}async cachePath(t){const{format:n}=this.options;return`.observable/cache/${await Kt(this.name)}-${await Sr(t)}${Rr(n)}`}}Qt.prototype=Je.prototype;Object.defineProperty(Je,"name",{value:"Interpreter"});var kr=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},Dr=function(e,t,n,o,r){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},be;class jr{constructor(){be.set(this,void 0),Object.defineProperty(this,"fulfilled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rejected",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.next()}async next(){const t=await kr(this,be,"f");return Dr(this,be,new Promise((n,o)=>(this.fulfilled=n,this.rejected=o)),"f"),{done:!1,value:t}}throw(){return{done:!0}}return(){return{done:!0}}}be=new WeakMap;const Fr=()=>w(()=>import("https://cdn.jsdelivr.net/npm/lodash/+esm"),[],import.meta.url).then(e=>e.default),Br=()=>w(()=>import("https://cdn.jsdelivr.net/npm/arquero/+esm"),[],import.meta.url),Vr=()=>w(()=>import("https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm"),[],import.meta.url),Gr=()=>w(()=>import("https://cdn.jsdelivr.net/npm/d3/+esm"),[],import.meta.url),Ur=()=>w(()=>import("./dot-DSyh6hFx.js"),[],import.meta.url).then(e=>e.dot),zr=()=>w(()=>import("https://cdn.jsdelivr.net/npm/@duckdb/duckdb-wasm@1.29.0/+esm"),[],import.meta.url),Yr=()=>w(()=>import("./duckdb-D2zCFoMh.js"),[],import.meta.url).then(e=>e.DuckDBClient),Wr=()=>w(()=>import("https://cdn.jsdelivr.net/npm/echarts/dist/echarts.esm.min.js/+esm"),[],import.meta.url),Hr=()=>w(()=>import("https://cdn.jsdelivr.net/npm/htl/+esm"),[],import.meta.url),Xr=()=>w(()=>import("https://cdn.jsdelivr.net/npm/htl/+esm"),[],import.meta.url).then(e=>e.html),Jr=()=>w(()=>import("https://cdn.jsdelivr.net/npm/htl/+esm"),[],import.meta.url).then(e=>e.svg),Kr=()=>w(()=>import("./inputs-DoHVubAa.js"),__vite__mapDeps([0,1]),import.meta.url),Zr=()=>w(()=>import("./leaflet-D54mqpIu.js"),[],import.meta.url),Qr=()=>w(()=>import("./mapboxgl-C94UFoDx.js"),[],import.meta.url).then(e=>e.default),ei=()=>w(()=>import("./md-S5GvolQE.js"),[],import.meta.url).then(e=>e.md),ti=()=>w(()=>import("./mermaid-BMsol7BT.js"),[],import.meta.url).then(e=>e.mermaid),ni=()=>w(()=>import("https://cdn.jsdelivr.net/npm/@observablehq/plot/+esm"),[],import.meta.url),oi=()=>w(()=>import("https://cdn.jsdelivr.net/npm/react/+esm"),[],import.meta.url),ri=()=>w(()=>import("https://cdn.jsdelivr.net/npm/react-dom/client/+esm"),[],import.meta.url),ii=()=>w(()=>import("./tex-BE43Lb2g.js"),[],import.meta.url).then(e=>e.tex),si=()=>w(()=>import("https://cdn.jsdelivr.net/npm/topojson-client/+esm"),[],import.meta.url),ai=()=>w(()=>import("./vega-lite-ClQwpDTB.js"),[],import.meta.url).then(e=>e.vl),ui=Object.freeze(Object.defineProperty({__proto__:null,Arrow:Vr,DuckDBClient:Yr,Inputs:Kr,L:Zr,Plot:ni,React:oi,ReactDOM:ri,_:Fr,aq:Br,d3:Gr,dot:Ur,duckdb:zr,echarts:Wr,htl:Hr,html:Xr,mapboxgl:Qr,md:ei,mermaid:ti,svg:Jr,tex:ii,topojson:si,vl:ai},Symbol.toStringTag,{value:"Module"}));Ke.resolve=en;function Ke(...e){return e.length===1?import(en(e[0])):Promise.all(e.map(t=>Ke(t))).then(t=>Object.assign({},...t))}function li(e){const t=e.split("/"),n=e.startsWith("@")?[t.shift(),t.shift()].join("/"):t.shift(),o=n.indexOf("@",1),r=o>0?n.slice(0,o):n,i=o>0?n.slice(o):"",s=t.length>0?`/${t.join("/")}`:"";return{name:r,range:i,path:s}}function en(e){const t=String(e);if(ci(t)||di(t))return t;const{name:n,range:o,path:r}=li(t);return`https://cdn.jsdelivr.net/npm/${n}${o}${r+(fi(r)||pi(r)?"":"/+esm")}`}function ci(e){return/^\w+:/.test(e)}function di(e){return/^(\.\/|\.\.\/|\/)/.test(e)}function fi(e){return/(\.\w*)$/.test(e)}function pi(e){return/(\/)$/.test(e)}const mi=()=>R(q("aapl.csv")),hi=()=>R(q("alphabet.csv")),_i=()=>R(q("cars.csv")),bi=()=>R(q("citywages.csv")),gi=()=>R(q("diamonds.csv")),yi=()=>R(q("flare.csv")),vi=()=>R(q("industries.csv")),wi=()=>Pi(q("miserables.json")),Ei=()=>R(q("olympians.csv")),Si=()=>R(q("penguins.csv")),xi=()=>R(q("pizza.csv")),Ai=()=>R(q("weather.csv"));function q(e){return`https://cdn.jsdelivr.net/npm/@observablehq/sample-datasets/${e}`}async function Pi(e){const t=await fetch(e);if(!t.ok)throw new Error(`unable to fetch ${e}: status ${t.status}`);return t.json()}async function Ci(e){const t=await fetch(e);if(!t.ok)throw new Error(`unable to fetch ${e}: status ${t.status}`);return t.text()}async function R(e,t){const[n,o]=await Promise.all([Ci(e),w(()=>import("https://cdn.jsdelivr.net/npm/d3-dsv/+esm"),[],import.meta.url)]);return o.csvParse(n,o.autoType)}const Ii=Object.freeze(Object.defineProperty({__proto__:null,aapl:mi,alphabet:hi,cars:_i,citywages:bi,diamonds:gi,flare:yi,industries:vi,miserables:wi,olympians:Ei,penguins:Si,pizza:xi,weather:Ai},Symbol.toStringTag,{value:"Module"})),Ti=document.querySelector("main")??document.body,$i={now:()=>Ht(),width:()=>Xt(Ti),DatabaseClient:()=>He,FileAttachment:()=>ze,Generators:()=>mr,Interpreter:()=>Qt,Mutable:()=>Jt,DOM:()=>qr,require:()=>Ke,__ojs_observer:()=>()=>new jr,...ui,...Ii};class Oi{constructor(t=$i){Object.defineProperty(this,"runtime",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"main",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n=new kt({...t,__ojs_runtime:()=>n});this.runtime=Object.assign(n,{fileAttachments:yr}),this.main=n.module()}define(t,n,o){_r(this.main,t,n,o)}}const xe=new Oi;xe.runtime;const Ni=xe.main,b=xe.define.bind(xe);Ni.constructor.prototype.defines=function(e){return this._scope.has(e)||this._builtins.has(e)||this._runtime._builtin._scope.has(e)};b({root:document.getElementById("cell-940"),expanded:[],variables:[]},{id:940,body:function(t,n){return t.range([1,250],{label:"Final golden age episode sequence number",value:n.S09E25,step:1})},inputs:["Inputs","productionCodeToEpisodeSequenceNumber"],outputs:void 0,output:"viewof$goldenAgeFinalEpisodeSequenceNumber",assets:void 0,autodisplay:!0,autoview:!0,automutable:!1});b({root:document.getElementById("cell-1199"),expanded:[],variables:[]},{id:1199,body:(e,t,n,o)=>e`| field   | value |
| ------ | -------- |
| Production code | \`${t[n].productionCode}\`       |
| Episode sequence number | \`${o}\` |
| Title  | \`${t[n].title}\`       |`,inputs:["md","cohortAllCohortAverages","goldenAgeFinalEpisodeIndex","goldenAgeFinalEpisodeSequenceNumber"],outputs:[],output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:void 0});b({root:document.getElementById("cell-897"),expanded:[],variables:[]},{id:897,body:function(t,n,o,r){return t.plot({width:600,padding:0,legend:!0,grid:!0,x:{label:"Episode",axis:"top"},y:{label:"Season"},color:{label:"Rating",type:"linear",scheme:"RdYlGn",legend:!0,domain:[0,10],unknown:"#ddd"},marks:[t.cell(n,{x:"episode",y:"season",fill:"cohortAverageRating",inset:.5,tip:!0,channels:{Title:i=>i.title?i.title:"???"}}),t.text(n,o({x:"episode",y:"season",text:i=>i.cohortAverageRating?.toFixed(1),fill:"cohortAverageRating"})),t.ruleY([n[r]],{x:"episode",y:"season",dy:10,stroke:"red"}),t.dot([n[r]],{x:"episode",y:"season",dy:10,fill:"red"})]})},inputs:["Plot","cohortAllCohortAverages","colorContrast","goldenAgeFinalEpisodeIndex"],outputs:void 0,output:"grid",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-1021"),expanded:[],variables:[]},{id:1021,body:function(t,n,o){return t.plot({height:640,marginLeft:100,x:{domain:[0,10],label:"Rating"},color:{label:"Rating",type:"linear",scheme:"RdYlGn",legend:!0,domain:[0,10],unknown:"#ddd"},grid:!0,marks:[t.frame(),t.dot(n,t.dodgeY({padding:-1,r:3,tip:!0,channels:{Title:r=>r.title?r.title:"???",productionCode:"productionCode"},x:"cohortAverageRating",fill:"cohortAverageRating",fy:(r,i)=>i<=o?"golden age":"post golden age"}))]})},inputs:["Plot","cohortAllCohortAverages","goldenAgeFinalEpisodeIndex"],outputs:void 0,output:"split",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-40"),expanded:[],variables:[]},{id:40,body:function(e,t){return e.plot({y:{grid:!0},marginLeft:50,height:640,y:{ticks:100},marks:[e.frame(),e.tickX(t,{x:"timestamp_in_ms",y:"episode_sequence_number",stroke:"character",strokeWidth:3,channels:{word_count:"word_count"},strokeOpacity:n=>n.character==="Lisa Simpson"?1:.05,tip:!0})]})},inputs:["Plot","goldenAgeLines"],outputs:void 0,output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-1554"),expanded:[],variables:[]},{id:1554,body:(e,t)=>e`And now as a proportion of all words spoken per episode. We see that episode ${t.episodeSequenceNumber} (${t.productionCode}), <cite>${t.title}</cite>, is the episode with the most Lisa lines in it (${(t.lisaProportion*100).toFixed(1)}%):`,inputs:["md","exampleDot"],outputs:[],output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:void 0});b({root:document.getElementById("cell-1475"),expanded:[],variables:[]},{id:1475,body:function(e,t,n){return e.plot({nice:!0,height:640,x:{grid:!0,label:"Proportion of words spoken (%)",percent:!0},y:{domain:t},marks:[e.frame(),e.barX(n,e.stackX({order:null,offset:"expand"},e.groupY({x:"sum",fillOpacity:o=>o[0].character==="Lisa Simpson"?1:.1},{fill:"character",tip:!0,y:"episode_sequence_number",x:"word_count"})))]})},inputs:["Plot","sortedByLisaProportionLisaEpisodes","sortedByLisaGoldenAgeLines"],outputs:void 0,output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-2275"),expanded:[],variables:[]},{id:2275,body:(e,t,n)=>e`For example, episode ${t.productionCode} (_${t.title}_), for cohort \`${t.age}\` / \`${t.gender}\` has an average rating of <span style="color: ${n.scale("color").apply(t.cohortAverageRating)}">⬤</span> ${t.cohortAverageRating.toFixed(1)}. The regression line is NOT against these average cohort ratings, but against the "synthetic" data points that would otherwise be at the specified rating levels. Each dot is scaled by total vote count for that episode in that cohort.`,inputs:["md","exampleDot","mainPlot"],outputs:[],output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:void 0});b({root:document.getElementById("cell-674"),expanded:[],variables:[]},{id:674,body:function(t,n,o,r){return t.plot({width:n,color:{label:"Rating",type:"linear",scheme:"RdYlGn",legend:!0,domain:[0,10],unknown:"#ddd"},r:{range:[0,10]},x:{domain:[0,.3],label:"Proportion of words spoken by Lisa (%) →"},marginRight:200,fx:{domain:["males","all","females"]},fy:{domain:["all","aged_under_18","aged_18_29","aged_30_44","aged_45_plus"]},marks:[t.frame(),t.linearRegressionY(o,{x:"lisaProportion",y:"rating",fx:"gender",fy:"age"}),t.dot(r,{x:"lisaProportion",y:"cohortAverageRating",fx:"gender",fy:"age",opacity:.2,r:"cohortTotalVotes",fill:"cohortAverageRating",stroke:"black",tip:!0,channels:{S_E_:"seNum",episode:"ep",cohort:"cohort"}})]})},inputs:["Plot","width","exploded","cohortAverages"],outputs:void 0,output:"mainPlot",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-1163"),expanded:[],variables:[]},{id:1163,body:function(e,t){return e(t.filter(n=>n.lisaProportion&&n.age!=="all"&&n.gender!=="all"))},inputs:["anova","exploded"],outputs:void 0,output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-2081"),expanded:[],variables:[]},{id:2081,body:function(t){return t-1},inputs:["goldenAgeFinalEpisodeSequenceNumber"],outputs:void 0,output:"goldenAgeFinalEpisodeIndex",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-911"),expanded:[],variables:[]},{id:911,body:async(e,t)=>{const{colorContrast:n}=await w(()=>import("https://api.observablehq.com/@observablehq/plot-colorcontrast-custom-transform.js?v=4"),[],import.meta.url).then(o=>{const r={},i=e.module(o.default),s=e.module();if(!i.defines("colorContrast"))throw new SyntaxError("export 'colorContrast' not found");return s.variable(r.colorContrast=t()).import("colorContrast",i),r});return{colorContrast:n}},inputs:["__ojs_runtime","__ojs_observer"],outputs:["colorContrast"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});b({root:document.getElementById("cell-998"),expanded:[],variables:[]},{id:998,body:async(e,t)=>{const{settle:n}=await w(()=>import("https://api.observablehq.com/@mjbo/settling-input.js?v=4"),[],import.meta.url).then(o=>{const r={},i=e.module(o.default),s=e.module();if(!i.defines("settle"))throw new SyntaxError("export 'settle' not found");return s.variable(r.settle=t()).import("settle",i),r});return{settle:n}},inputs:["__ojs_runtime","__ojs_observer"],outputs:["settle"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});b({root:document.getElementById("cell-1003"),expanded:[],variables:[]},{id:1003,body:function(t,n){return t(n)},inputs:["settle","viewof$goldenAgeFinalEpisodeSequenceNumber"],outputs:void 0,output:"settledgoldenAgeFinalEpisodeSequenceNumber",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-972"),expanded:[],variables:[]},{id:972,body:function(t){return t-1},inputs:["settledgoldenAgeFinalEpisodeSequenceNumber"],outputs:void 0,output:"settledGoldenAgeFinalEpisodeIndex",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-4"),expanded:[],variables:[]},{id:4,body:async(e,t)=>{const{metaLines:n}=await w(()=>import("https://api.observablehq.com/@enjalot/simpsons-data.js?v=4"),[],import.meta.url).then(o=>{const r={},i=e.module(o.default),s=e.module();if(!i.defines("metaLines"))throw new SyntaxError("export 'metaLines' not found");return s.variable(r.metaLines=t()).import("metaLines",i),r});return{metaLines:n}},inputs:["__ojs_runtime","__ojs_observer"],outputs:["metaLines"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});b({root:document.getElementById("cell-1427"),expanded:[],variables:[]},{id:1427,body:function(t){return t.map(n=>({episode_sequence_number:n.episode_id,timestamp_in_ms:n.timestamp_in_ms,speaking_line:n.speaking_line,character:n.raw_character_text,word_count:n.word_count}))},inputs:["metaLines"],outputs:void 0,output:"lines",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-1375"),expanded:[],variables:[]},{id:1375,body:function(e){return[...new Set(e.map(t=>t.episode_sequence_number))].toSorted((t,n)=>t-n)},inputs:["lines"],outputs:void 0,output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-74"),expanded:[],variables:[]},{id:74,body:function(t,n){return t.filter(o=>o.episode_sequence_number<=n&&o.speaking_line&&!isNaN(o.word_count)&&o.word_count<1e5)},inputs:["lines","settledgoldenAgeFinalEpisodeSequenceNumber"],outputs:void 0,output:"goldenAgeLines",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-1362"),expanded:[],variables:[]},{id:1362,body:function(e){return e.filter(t=>t.word_count>1e5)},inputs:["lines"],outputs:void 0,output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-1536"),expanded:[],variables:[]},{id:1536,body:function(t){return t.sort((n,o)=>{const r=n.character==="Lisa Simpson";return(o.character==="Lisa Simpson")-r})},inputs:["goldenAgeLines"],outputs:void 0,output:"sortedByLisaGoldenAgeLines",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-599"),expanded:[],variables:[]},{id:599,body:function(t){const n={},o={},r={};for(const i of t)n[i.episode_sequence_number]=(n[i.episode_sequence_number]??0)+i.word_count,i.character==="Lisa Simpson"&&(o[i.episode_sequence_number]=(o[i.episode_sequence_number]??0)+i.word_count);for(const i of Object.keys(n))r[i]=o[i]/n[i];return r},inputs:["goldenAgeLines"],outputs:void 0,output:"episodeSequenceNumberToLisaProportion",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-1466"),expanded:[],variables:[]},{id:1466,body:function(t){return Object.entries(t).toSorted((n,o)=>o[1]-n[1]).map(n=>Number(n[0]))},inputs:["episodeSequenceNumberToLisaProportion"],outputs:void 0,output:"sortedByLisaProportionLisaEpisodes",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-2425"),expanded:[],variables:[]},{id:2425,body:function(t){return t(new URL(""+new URL("all_ratingsbydemo_20200824_115720-D894_FAA.tsv",import.meta.url).href,import.meta.url).href).tsv({typed:!0})},inputs:["FileAttachment"],outputs:void 0,output:"ratings",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-649"),expanded:[],variables:[]},{id:649,body:function(t){const n={};return[...new Set(t.map(o=>o.seNum))].toSorted().forEach((o,r)=>{n[o]=r+1}),n},inputs:["ratings"],outputs:void 0,output:"productionCodeToEpisodeSequenceNumber",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-925"),expanded:[],variables:[]},{id:925,body:async(e,t)=>{const{simpsons:n}=await w(()=>import("https://api.observablehq.com/@observablehq/plot-simpsons-ratings.js?v=4"),[],import.meta.url).then(o=>{const r={},i=e.module(o.default),s=e.module();if(!i.defines("simpsons"))throw new SyntaxError("export 'simpsons' not found");return s.variable(r.simpsons=t()).import("simpsons",i),r});return{episodeMetadata:n}},inputs:["__ojs_runtime","__ojs_observer"],outputs:["episodeMetadata"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});b({root:document.getElementById("cell-2319"),expanded:[],variables:[]},{id:2319,body:function(t){const n={};for(const o of t)n[o.id]=o;return n},inputs:["episodeMetadata"],outputs:void 0,output:"episodeSequenceNumberToMetadata",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-2174"),expanded:[],variables:[]},{id:2174,body:function(){return new Set(["all","aged_under_18","aged_18_29","aged_30_44","aged_45_plus"])},inputs:[],outputs:void 0,output:"AGE_DOMAIN",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-2177"),expanded:[],variables:[]},{id:2177,body:function(){return new Set(["males","all","females"])},inputs:[],outputs:void 0,output:"GENDER_DOMAIN",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-668"),expanded:[],variables:[]},{id:668,body:function(t,n,o,r,i,s,a){return t.map(u=>({...u,productionCode:u.seNum,episodeSequenceNumber:n[u.seNum]})).map(u=>({episodeSequenceNumber:u.episodeSequenceNumber,productionCode:u.productionCode,...o(u.productionCode),lisaProportion:r[n[u.productionCode]],rating:u.rating,votes:u.votes,title:i[u.episodeSequenceNumber]?.title,gender:u.cat_b==="gender"?u.cat_c:u.cat_b,age:u.cat_b==="gender"?"all":u.cat_c,cohort:u.episodeSequenceNumber+"|"+u.cat_a+"|"+u.cat_b+"|"+u.cat_c})).filter(u=>s.has(u.age)&&a.has(u.gender))},inputs:["ratings","productionCodeToEpisodeSequenceNumber","parseSeasonAndEpisode","episodeSequenceNumberToLisaProportion","episodeSequenceNumberToMetadata","AGE_DOMAIN","GENDER_DOMAIN"],outputs:void 0,output:"tidy",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-686"),expanded:[],variables:[]},{id:686,body:function(t){const n={},o={},r={};for(const i of t)n[i.cohort]=(n[i.cohort]??0)+i.votes,o[i.cohort]=(o[i.cohort]??0)+i.votes*i.rating;for(const i of Object.keys(o))r[i]=o[i]/n[i];return{cohortAverageRating:r,cohortTotalVotes:n}},inputs:["tidy"],outputs:void 0,output:"cohortToAverageRatingAndTotalVotesPerEp",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-906"),expanded:[],variables:[]},{id:906,body:function(){return(function(n){const o=n.match(/S(\d+)E(\d+)/i);if(o)return{season:parseInt(o[1]),episode:parseInt(o[2])};throw new Error("failed parse")})},inputs:[],outputs:void 0,output:"parseSeasonAndEpisode",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-2260"),expanded:[],variables:[]},{id:2260,body:function(t){return t.filter(n=>n.age==="aged_18_29"&&n.gender==="males").toSorted((n,o)=>o.lisaProportion-n.lisaProportion)[0]},inputs:["cohortAverages"],outputs:void 0,output:"exampleDot",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-706"),expanded:[],variables:[]},{id:706,body:function(t,n,o){const r=t.map(i=>({...i,cohortAverageRating:n.cohortAverageRating[i.cohort],cohortTotalVotes:n.cohortTotalVotes[i.cohort]}));return o.uniqBy(r,"cohort")},inputs:["tidy","cohortToAverageRatingAndTotalVotesPerEp","_"],outputs:void 0,output:"cohortAverages",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-824"),expanded:[],variables:[]},{id:824,body:function(t){const n=[];for(const o of t)for(let r=0;r<o.votes;++r)n.push(o);return n},inputs:["tidy"],outputs:void 0,output:"exploded",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-902"),expanded:[],variables:[]},{id:902,body:function(t){return t.filter(n=>n.gender==="all"&&n.age==="all").filter(n=>n.cohortAverageRating)},inputs:["cohortAverages"],outputs:void 0,output:"cohortAllCohortAverages",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});b({root:document.getElementById("cell-2206"),expanded:[],variables:[]},{id:2206,body:function(){return(async function(n){function o(c){return c.reduce((h,_)=>h+_,0)/c.length}function r(c,h,_){const m=h*c/(h*c+_);return i(m,h/2,_/2)}function i(c,h,_){if(c<=0)return 0;if(c>=1)return 1;const m=a(h)+a(_)-a(h+_),P=Math.exp(Math.log(c)*h+Math.log(1-c)*_-m)/h,C=s(c,h,_);return P*C}function s(c,h,_,m=100){const P=h+_,C=h+1,p=h-1;let S=1,y=1-P*c/C;Math.abs(y)<1e-30&&(y=1e-30),y=1/y;let M=y;for(let v=1;v<=m;v++){const x=2*v;let $=v*(_-v)*c/((p+x)*(h+x));y=1+$*y,Math.abs(y)<1e-30&&(y=1e-30),S=1+$/S,Math.abs(S)<1e-30&&(S=1e-30),y=1/y,M*=y*S,$=-(h+v)*(P+v)*c/((h+x)*(C+x)),y=1+$*y,Math.abs(y)<1e-30&&(y=1e-30),S=1+$/S,Math.abs(S)<1e-30&&(S=1e-30),y=1/y;const Z=y*S;if(M*=Z,Math.abs(Z-1)<1e-10)break}return M}function a(c){const _=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(c<.5)return Math.log(Math.PI)-Math.log(Math.sin(Math.PI*c))-a(1-c);c-=1;let m=_[0];for(let C=1;C<9;C++)m+=_[C]/(c+C);const P=c+7+.5;return .5*Math.log(2*Math.PI)+(c+.5)*Math.log(P)-P+Math.log(m)}function u(c){if(c<22e-17)return"< 2.2e-16";if(c<.001){let h=c.toExponential(3);return h=h.replace(/e-(\d)$/,"e-0$1"),h}return c.toFixed(4)}function l(c){return c<.001?" ***":c<.01?" ** ":c<.05?" *  ":c<.1?" .  ":"    "}function d(c,h){const _=[];for(let m=1;m<h.length;m++)_.push(c.map(P=>P===h[m]?1:0));return _}function f(c,h){const _=[];for(const m of c)for(const P of h)_.push(m.map((C,p)=>C*P[p]));return _}function A(c,h){const _=c.length,m=c.map((p,S)=>[...p,h[S]]),P=1e-10;for(let p=0;p<_;p++){let S=p;for(let y=p+1;y<_;y++)Math.abs(m[y][p])>Math.abs(m[S][p])&&(S=y);if([m[p],m[S]]=[m[S],m[p]],!(Math.abs(m[p][p])<P))for(let y=p+1;y<_;y++){const M=m[y][p]/m[p][p];for(let v=p;v<=_;v++)m[y][v]-=M*m[p][v]}}const C=Array(_).fill(0);for(let p=_-1;p>=0;p--){if(Math.abs(m[p][p])<P){C[p]=0;continue}C[p]=m[p][_];for(let S=p+1;S<_;S++)C[p]-=m[p][S]*C[S];C[p]/=m[p][p]}return C}function g(c,h){const _=c.length,m=h.length+1,P=Array(_).fill(null).map(()=>Array(m).fill(0));for(let v=0;v<_;v++){P[v][0]=1;for(let x=0;x<h.length;x++)P[v][x+1]=h[x][v]}const C=Array(m).fill(null).map(()=>Array(m).fill(0));for(let v=0;v<m;v++)for(let x=0;x<m;x++)for(let $=0;$<_;$++)C[v][x]+=P[$][v]*P[$][x];const p=Array(m).fill(0);for(let v=0;v<m;v++)for(let x=0;x<_;x++)p[v]+=P[x][v]*c[x];const S=A(C,p),y=P.map(v=>v.reduce((x,$,Z)=>x+$*S[Z],0)),M=c.reduce((v,x,$)=>v+(x-y[$])**2,0);return{beta:S,fitted:y,rss:M}}const N=n.filter(c=>c.rating!=null&&c.lisaProportion!=null&&c.age!=null&&c.gender!=null&&!isNaN(c.rating)&&!isNaN(c.lisaProportion)),E=N.map(c=>c.rating),I=N.map(c=>c.lisaProportion),T=N.map(c=>c.age),H=N.map(c=>c.gender),Ce=E.length,tn=o(E),nn=E.reduce((c,h)=>c+(h-tn)**2,0),Ze=[...new Set(T)].sort(),Qe=[...new Set(H)].sort(),U=d(T,Ze),X=d(H,Qe),ce=f([I],U),Ie=f([I],X),Te=f(U,X),on=f([I],Te);let rn=nn;const et=g(E,[I]).rss,tt=rn-et,nt=g(E,[I,...U]).rss,ot=et-nt,rt=g(E,[I,...U,...X]).rss,it=nt-rt,st=g(E,[I,...U,...X,...ce]).rss,at=rt-st,ut=g(E,[I,...U,...X,...ce,...Ie]).rss,lt=st-ut,ct=g(E,[I,...U,...X,...ce,...Ie,...Te]).rss,dt=ut-ct,ft=g(E,[I,...U,...X,...ce,...Ie,...Te,...on]).rss,pt=ct-ft,mt=ft,de=1,J=Ze.length-1,K=Qe.length-1,fe=J,pe=K,me=J*K,he=J*K,D=Ce-(1+de+J+K+fe+pe+me+he),ht=tt/de,_t=ot/J,bt=it/K,gt=at/fe,yt=lt/pe,vt=dt/me,wt=pt/he,z=mt/D,$e=ht/z,Oe=_t/z,Ne=bt/z,Et=gt/z,St=yt/z,Le=vt/z,xt=wt/z,sn=$e>100?0:1-r($e,de,D),an=Oe>100?0:1-r(Oe,J,D),un=Ne>100?0:1-r(Ne,K,D),ln=1-r(Et,fe,D),cn=1-r(St,pe,D),dn=Le>100?0:1-r(Le,me,D),fn=1-r(xt,he,D),Y=[];Y.push(`Analysis of Variance Table
`),Y.push("Response: rating"),Y.push("                              Df  Sum Sq Mean Sq  F value    Pr(>F)    ");const pn=[["lisaProportion",de,tt,ht,$e,sn],["age",J,ot,_t,Oe,an],["gender",K,it,bt,Ne,un],["lisaProportion:age",fe,at,gt,Et,ln],["lisaProportion:gender",pe,lt,yt,St,cn],["age:gender",me,dt,vt,Le,dn],["lisaProportion:age:gender",he,pt,wt,xt,fn],["Residuals",D,mt,z,null,null]];for(const[c,h,_,m,P,C]of pn){const p=h.toString(),S=31-p.length,y=c.padEnd(S),M=Math.round(_).toString().padStart(8),v=m.toFixed(1).padStart(8);if(P===null){const x=" ".repeat(23);Y.push(`${y}${p}${M}${v}${x}`)}else{const x=P.toFixed(3).padStart(9),$=u(C).padStart(10),Z=l(C);Y.push(`${y}${p}${M}${v}${x}${$}${Z}`)}}return Y.push("---"),Y.push("Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"),Y.join(`
`)})},inputs:[],outputs:void 0,output:"anova",assets:void 0,autodisplay:!0,autoview:!1,automutable:!1});export{w as _};
